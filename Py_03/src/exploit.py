from bs4 import BeautifulSoup
import sys
# read evilcorp.html
try:
    with open("../materials/evilcorp.html") as fp:
        soup = BeautifulSoup(fp, features="lxml")
except FileNotFoundError:
    print("File not found or Error parsing HTML")
    sys.exit(1)
# change title
soup.title.string = "Evil Corp - Stealing your money every day"
name = soup.select_one("span.name")
pronaun = soup.select_one("span.pronoun")
# add hacked sentence
h1 = soup.new_tag('h1')
h1.string = f"{name.text}, you are hacked!"
body = soup.find('body')
body.insert(0, h1)

# add reference to fsociety
soup.a["href"] = "https://mrrobot.fandom.com/wiki/Fsociety"
soup.a.string = "Fsociety"

# add trenton's script
with open("trenton_script.txt") as tf:
    script = BeautifulSoup(tf.read(), features="lxml")
    body = soup.find('body')
    body.insert(0, script)


# write to file evilcorp_hacked.html in materials
with open("../materials/evilcorp_hacked.html", "w") as fp:
    fp.write(str(soup.prettify()))
